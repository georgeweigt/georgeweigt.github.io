\input{preamble}

% Feynman and Hibbs problem 4-2

\section*{Schrodinger from Lagrangian 2}

This is the Schrodinger equation for a charged particle.
\begin{multline*}
i\hbar\frac{\partial\psi}{\partial t}
=\frac{1}{2m}\left(\frac{\hbar}{i}\nabla-\frac{q}{c}\mathbf A\right)^2\psi+q\phi\psi
\\
=-\frac{\hbar^2}{2m}\nabla^2\psi
+\frac{i\hbar q}{2mc}\nabla\cdot\mathbf A\psi
+\frac{i\hbar q}{2mc}\mathbf A\cdot\nabla\psi
+\frac{q^2}{2mc^2}\mathbf A^2\psi
+q\phi\psi
\end{multline*}

Derive the Schrodinger equation from the Lagrangian
\begin{equation*}
L(\mathbf x,\dot{\mathbf x},t)=\frac{m\dot{\mathbf x}^2}{2}
+\frac{q}{c}\dot{\mathbf x}\cdot\mathbf A(\mathbf x,t)-q\phi(\mathbf x,t)
\end{equation*}

Note that
\begin{equation*}
\nabla\cdot\mathbf A\psi=(\nabla\cdot\mathbf A)\psi+\mathbf A\cdot\nabla\psi
\end{equation*}

Hence for the Coulomb gauge $\nabla\cdot\mathbf A=0$ the Schrodinger equation is
\begin{equation*}
i\hbar\frac{\partial\psi}{\partial t}
=-\frac{\hbar^2}{2m}\nabla^2\psi
+\frac{i\hbar q}{mc}\mathbf A\cdot\nabla\psi
+\frac{q^2}{2mc^2}\mathbf A^2\psi
+q\phi\psi
\tag{1}
\end{equation*}

Start with the path integral for an action $S$.
\begin{equation*}
\psi(\mathbf x_b,t_b)
=C\int_{\mathbb R^3}\exp\left(\frac{i}{\hbar}S(b,a)\right)
\psi(\mathbf x_a,t_a)\,d\mathbf x_a,\quad
\int_{\mathbb R^3}\equiv\int\limits_{-\infty}^\infty\int\limits_{-\infty}^\infty\int\limits_{-\infty}^\infty
\end{equation*}

For a small time interval $\epsilon=t_b-t_a$ we can use the approximation
\begin{equation*}
S=\epsilon L
\end{equation*}

and write the path integral as
\begin{equation*}
\psi(\mathbf x_b,t+\epsilon)=C\int_{\mathbb R^3}
\exp\left[\frac{i}{\hbar}
\epsilon L\left(\frac{\mathbf x_b-\mathbf x_a}{\epsilon},\frac{\mathbf x_b+\mathbf x_a}{2},t\right)
\right]
\psi(\mathbf x_a,t)\,d\mathbf x_a
\end{equation*}

Substitute for $L$.
\begin{multline*}
\psi(\mathbf x_b,t+\epsilon)=C\int_{\mathbb R^3}
\exp\biggl[\frac{im(\mathbf x_b-\mathbf x_a)^2}{2\hbar\epsilon}
+\frac{iq}{\hbar c}(\mathbf x_b-\mathbf x_a)
\cdot\mathbf A\left(\frac{\mathbf x_b+\mathbf x_a}{2},t\right)
\\
{}-\frac{iq\epsilon}{\hbar}\phi\left(\frac{\mathbf x_b+\mathbf x_a}{2},t\right)
\biggr]
\psi(\mathbf x_a,t)
\,d\mathbf x_a
\end{multline*}

Let
\begin{equation*}
\mathbf x_a=\mathbf x_b+\boldsymbol\eta,\quad
d\mathbf x_a=d\boldsymbol\eta
\end{equation*}

and write
\begin{equation*}
\psi(\mathbf x_b,t+\epsilon)
=C\int_{\mathbb R^3}
\exp\left[\frac{im\boldsymbol\eta^2}{2\hbar\epsilon}
-\frac{iq}{\hbar c}
\boldsymbol\eta\cdot\mathbf A\left(\mathbf x_b+\frac{\boldsymbol\eta}{2},t\right)
-\frac{iq\epsilon}{\hbar}\phi\left(\mathbf x_b+\frac{\boldsymbol\eta}{2},t\right)
\right]
\psi(\mathbf x_b+\boldsymbol\eta,t)
\,d\boldsymbol\eta
\end{equation*}

Substitute $\mathbf x$ for $\mathbf x_b$.
\begin{equation*}
\psi(\mathbf x,t+\epsilon)
=C\int_{\mathbb R^3}
\exp\left[\frac{im\boldsymbol\eta^2}{2\hbar\epsilon}
-\frac{iq}{\hbar c}
\boldsymbol\eta\cdot\mathbf A\left(\mathbf x+\frac{\boldsymbol\eta}{2},t\right)
-\frac{iq\epsilon}{\hbar}\phi\left(\mathbf x+\frac{\boldsymbol\eta}{2},t\right)
\right]
\psi(\mathbf x+\boldsymbol\eta,t)
\,d\boldsymbol\eta
\end{equation*}

Because the exponential is highly oscillatory for large $|\boldsymbol\eta|$,
most of the contribution to the integral is from small $|\boldsymbol\eta|$.
Hence use the approximation $\mathbf x+\tfrac{1}{2}\boldsymbol\eta\approx\mathbf x$
for small $|\boldsymbol\eta|$.
\begin{equation*}
\psi(\mathbf x,t+\epsilon)
=C\int_{\mathbb R^3}
\exp\left(\frac{im\boldsymbol\eta^2}{2\hbar\epsilon}
-\frac{iq}{\hbar c}
\boldsymbol\eta\cdot\mathbf A(\mathbf x,t)
-\frac{iq\epsilon}{\hbar}\phi\left(\mathbf x,t\right)
\right)
\psi(\mathbf x+\boldsymbol\eta,t)
\,d\boldsymbol\eta
\end{equation*}

Use the approximation $\exp(y)\approx1+y$ for the exponential of $\phi$.
\begin{equation*}
\psi(\mathbf x,t+\epsilon)
=C\int_{\mathbb R^3}
\exp\left(\frac{im\boldsymbol\eta^2}{2\hbar\epsilon}
-\frac{iq}{\hbar c}
\boldsymbol\eta\cdot\mathbf A
\right)
\psi(\mathbf x+\boldsymbol\eta,t)
\,d\boldsymbol\eta
\times\left(1-\frac{iq\epsilon}{\hbar}\phi\right)
\end{equation*}

Expand $\psi(\mathbf x+\boldsymbol\eta,t)$ as the power series
\begin{equation*}
\psi(\mathbf x+\boldsymbol\eta,t)\approx
\psi
+\boldsymbol\eta\cdot\nabla\psi
+\tfrac{1}{2}\boldsymbol\eta^2\nabla^2\psi
\end{equation*}

to obtain
\begin{equation*}
\psi(\mathbf x,t+\epsilon)
=C\int_{\mathbb R^3}
\exp\left(\frac{im\boldsymbol\eta^2}{2\hbar\epsilon}
-\frac{iq}{\hbar c}\boldsymbol\eta\cdot\mathbf A\right)
\left(
\psi
+\boldsymbol\eta\cdot\nabla\psi
+\tfrac{1}{2}\boldsymbol\eta^2\nabla^2\psi
\right)
\,d\boldsymbol\eta
\times\left(1-\frac{iq\epsilon}{\hbar}\phi\right)
\end{equation*}

Rewrite as
\begin{equation*}
\psi(\mathbf x,t+\epsilon)
=C(I_1+I_2+I_3)\left(1-\frac{iq\epsilon}{\hbar}\phi\right)
\tag{2}
\end{equation*}

where
\begin{align*}
I_1&=\int_{\mathbb R^3}
\exp\left(\frac{im\boldsymbol\eta^2}{2\hbar\epsilon}
-\frac{iq}{\hbar c}\boldsymbol\eta\cdot\mathbf A\right)
\psi\,d\boldsymbol\eta
\\
I_2&=\int_{\mathbb R^3}
\exp\left(\frac{im\boldsymbol\eta^2}{2\hbar\epsilon}
-\frac{iq}{\hbar c}\boldsymbol\eta\cdot\mathbf A\right)
\boldsymbol\eta\cdot\nabla\psi
\,d\boldsymbol\eta
\\
I_3&=\int_{\mathbb R^3}
\exp\left(\frac{im\boldsymbol\eta^2}{2\hbar\epsilon}
-\frac{iq}{\hbar c}\boldsymbol\eta\cdot\mathbf A\right)
\tfrac{1}{2}\boldsymbol\eta^2\nabla^2\psi
\,d\boldsymbol\eta
\end{align*}

The solutions are
\begin{align*}
I_1&=\left(\frac{2\pi i\hbar\epsilon}{m}\right)^\frac{3}{2}
\exp\left(-\frac{iq^2\epsilon}{2\hbar mc^2}\mathbf A^2\right)\psi
\\
I_2&=\left(\frac{2\pi i\hbar\epsilon}{m}\right)^\frac{3}{2}
\exp\left(-\frac{iq^2\epsilon}{2\hbar mc^2}\mathbf A^2\right)
\frac{q\epsilon}{mc}
\mathbf A\cdot\nabla\psi
\\
I_3&=\left(\frac{2\pi i\hbar\epsilon}{m}\right)^\frac{3}{2}
\exp\left(-\frac{iq^2\epsilon}{2\hbar mc^2}\mathbf A^2\right)
\frac{i\hbar\epsilon}{2m}\nabla^2\psi
\end{align*}

Use the approximation $\exp(y)\approx1+y$ to write the solutions this way.
\begin{align*}
I_1&=\left(\frac{2\pi i\hbar\epsilon}{m}\right)^\frac{3}{2}
\left(1-\frac{iq^2\epsilon}{2\hbar mc^2}\mathbf A^2\right)\psi
\\
I_2&=\left(\frac{2\pi i\hbar\epsilon}{m}\right)^\frac{3}{2}
\left(1-\frac{iq^2\epsilon}{2\hbar mc^2}\mathbf A^2\right)
\frac{q\epsilon}{mc}
\mathbf A\cdot\nabla\psi
\\
I_3&=\left(\frac{2\pi i\hbar\epsilon}{m}\right)^\frac{3}{2}
\left(1-\frac{iq^2\epsilon}{2\hbar mc^2}\mathbf A^2\right)
\frac{i\hbar\epsilon}{2m}\nabla^2\psi
\end{align*}

Discard terms of order $\epsilon^2$.
\begin{equation*}
I_1+I_2+I_3=\left(\frac{2\pi i\hbar\epsilon}{m}\right)^\frac{3}{2}
\left(
\psi
+\frac{i\hbar\epsilon}{2m}\nabla^2\psi
+\frac{q\epsilon}{mc}\mathbf A\cdot\nabla\psi
-\frac{iq^2\epsilon}{2\hbar mc^2}\mathbf A^2\psi
\right)
\end{equation*}

Let
\begin{equation*}
C=\left(\frac{2\pi i\hbar\epsilon}{m}\right)^{-\frac{3}{2}}
\end{equation*}

Substitute $C$ and $I_1+I_2+I_3$ into equation (2) to obtain
\begin{equation*}
\psi(\mathbf x,t+\epsilon)
=\left(\psi
+\frac{i\hbar\epsilon}{2m}\nabla^2\psi
+\frac{q\epsilon}{mc}\mathbf A\cdot\nabla\psi
-\frac{iq^2\epsilon}{2\hbar mc^2}\mathbf A^2\psi
\right)
\left(1-\frac{iq\epsilon}{\hbar}\phi\right)
\end{equation*}

Discard terms of order $\epsilon^2$.
\begin{equation*}
\psi(\mathbf x,t+\epsilon)
=\psi
+\frac{i\hbar\epsilon}{2m}\nabla^2\psi
+\frac{q\epsilon}{mc}\mathbf A\cdot\nabla\psi
-\frac{iq^2\epsilon}{2\hbar mc^2}\mathbf A^2\psi
-\frac{iq\epsilon}{\hbar}\phi\psi
\end{equation*}

Expand $\psi(\mathbf x,t+\epsilon)$ as the power series
\begin{equation*}
\psi(\mathbf x,t+\epsilon)\approx\psi+\epsilon\frac{\partial\psi}{\partial t}
\end{equation*}

to obtain
\begin{equation*}
\psi+\epsilon\frac{\partial\psi}{\partial t}
=\psi
+\frac{i\hbar\epsilon}{2m}\nabla^2\psi
+\frac{q\epsilon}{mc}\mathbf A\cdot\nabla\psi
-\frac{iq^2\epsilon}{2\hbar mc^2}\mathbf A^2\psi
-\frac{iq\epsilon}{\hbar}\phi\psi
\end{equation*}

Cancel leading $\psi$.
\begin{equation*}
\epsilon\frac{\partial\psi}{\partial t}
=\frac{i\hbar\epsilon}{2m}\nabla^2\psi
+\frac{q\epsilon}{mc}\mathbf A\cdot\nabla\psi
-\frac{iq^2\epsilon}{2\hbar mc^2}\mathbf A^2\psi
-\frac{iq\epsilon}{\hbar}\phi\psi
\end{equation*}

Multiply both sides by $i\hbar/\epsilon$.
\begin{equation*}
i\hbar\frac{\partial\psi}{\partial t}
=-\frac{\hbar^2}{2m}\nabla^2\psi
+\frac{i\hbar q}{mc}\mathbf A\cdot\nabla\psi
+\frac{q^2}{2mc^2}\mathbf A^2\psi
+q\phi\psi
\end{equation*}

\subsubsection*{Eigenmath code}

Table of Gaussian integrals for negative or imaginary coefficient $a$.
\begin{align*}
&\int_{-\infty}^\infty\exp(ay^2+by)\,dy
=\left(-\frac{\pi}{a}\right)^\frac{1}{2}
\exp\left(-\frac{b^2}{4a}\right)
\\
&\int_{-\infty}^\infty y\exp(ay^2+by)\,dy
=\left(-\frac{\pi}{a}\right)^\frac{1}{2}
\left(-\frac{b}{2a}\right)
\exp\left(-\frac{b^2}{4a}\right)
\\
&\int_{-\infty}^\infty y^2\exp(ay^2+by)\,dy
=\left(-\frac{\pi}{a}\right)^\frac{1}{2}
\left(-\frac{1}{2a}\right)
\left(1-\frac{b^2}{2a}\right)
\exp\left(-\frac{b^2}{4a}\right)
\end{align*}

{\footnotesize\begin{verbatim}
G0(a,b) = sqrt(-pi / a) exp(-b^2 / (4 a))
G1(a,b) = sqrt(-pi / a) (-b / (2 a)) exp(-b^2 / (4 a))
G2(a,b) = sqrt(-pi / a) (-1 / (2 a)) (1 - b^2 / (2 a)) exp(-b^2 / (4 a))
\end{verbatim}}

\begin{equation*}
a=\frac{im}{2\hbar\epsilon},\quad
b=-\frac{iq}{\hbar c}
\end{equation*}

\begin{align*}
I_1&=\int_{\mathbb R^3}
\exp\left(\frac{im\boldsymbol\eta^2}{2\hbar\epsilon}
-\frac{iq}{\hbar c}\boldsymbol\eta\cdot\mathbf A(\mathbf x,t)\right)
\psi\,d\boldsymbol\eta
\\
&=\int_{\mathbb R^3}
\exp\left(a\eta_x^2+b\eta_xA_x\right)
\exp\left(a\eta_y^2+b\eta_yA_y\right)
\exp\left(a\eta_z^2+b\eta_zA_z\right)
\psi\,d\eta_x\,d\eta_y\,d\eta_z
\end{align*}

{\footnotesize\begin{verbatim}
a = i m / (2 hbar epsilon)
b = -i q / (hbar c)
I1 = G0(a, b Ax) G0(a, b Ay) G0(a, b Az) psi
\end{verbatim}}

\begin{align*}
I_2&=\int_{\mathbb R^3}
\exp\left(\frac{im\boldsymbol\eta^2}{2\hbar\epsilon}
-\frac{iq}{\hbar c}\boldsymbol\eta\cdot\mathbf A(\mathbf x,t)\right)
\boldsymbol\eta\cdot\nabla\psi
\,d\boldsymbol\eta
\\
&=\int_{\mathbb R^3}
\exp\left(a\eta_x^2+b\eta_xA_x\right)
\exp\left(a\eta_y^2+b\eta_yA_y\right)
\exp\left(a\eta_z^2+b\eta_zA_z\right)\eta_x\frac{\partial\psi}{\partial x}
\,d\eta_x\,d\eta_y\,d\eta_z
\\
&\quad{}+\int_{\mathbb R^3}
\exp\left(a\eta_x^2+b\eta_xA_x\right)
\exp\left(a\eta_y^2+b\eta_yA_y\right)
\exp\left(a\eta_z^2+b\eta_zA_z\right)\eta_y\frac{\partial\psi}{\partial y}
\,d\eta_x\,d\eta_y\,d\eta_z
\\
&\quad\quad{}+\int_{\mathbb R^3}
\exp\left(a\eta_x^2+b\eta_xA_x\right)
\exp\left(a\eta_y^2+b\eta_yA_y\right)
\exp\left(a\eta_z^2+b\eta_zA_z\right)\eta_z\frac{\partial\psi}{\partial z}
\,d\eta_x\,d\eta_y\,d\eta_z
\end{align*}

{\footnotesize\begin{verbatim}
I2 = G1(a, b Ax) G0(a, b Ay) G0(a, b Az) d(psi(),x) +
     G0(a, b Ax) G1(a, b Ay) G0(a, b Az) d(psi(),y) +
     G0(a, b Ax) G0(a, b Ay) G1(a, b Az) d(psi(),z)
\end{verbatim}}

\begin{align*}
I_3&=\int_{\mathbb R^3}
\exp\left(\frac{im\boldsymbol\eta^2}{2\hbar\epsilon}
-\frac{iq}{\hbar c}\boldsymbol\eta\cdot\mathbf A(\mathbf x,t)\right)
\tfrac{1}{2}\boldsymbol\eta^2\nabla^2\psi
\,d\boldsymbol\eta
\\
&=\int_{\mathbb R^3}
\exp\left(a\eta_x^2+b\eta_xA_x\right)
\exp\left(a\eta_y^2+b\eta_yA_y\right)
\exp\left(a\eta_z^2+b\eta_zA_z\right)
\tfrac{1}{2}\eta_x^2\frac{\partial^2\psi}{\partial x^2}
\,d\eta_x\,d\eta_y\,d\eta_z
\\
&\quad{}+\int_{\mathbb R^3}
\exp\left(a\eta_x^2+b\eta_xA_x\right)
\exp\left(a\eta_y^2+b\eta_yA_y\right)
\exp\left(a\eta_z^2+b\eta_zA_z\right)
\tfrac{1}{2}\eta_y^2\frac{\partial^2\psi}{\partial y^2}
\,d\eta_x\,d\eta_y\,d\eta_z
\\
&\quad\quad{}+\int_{\mathbb R^3}
\exp\left(a\eta_x^2+b\eta_xA_x\right)
\exp\left(a\eta_y^2+b\eta_yA_y\right)
\exp\left(a\eta_z^2+b\eta_zA_z\right)
\tfrac{1}{2}\eta_z^2\frac{\partial^2\psi}{\partial z^2}
\,d\eta_x\,d\eta_y\,d\eta_z
\end{align*}

{\footnotesize\begin{verbatim}
I3 = G2(a, b Ax) G0(a, b Ay) G0(a, b Az) 1/2 d(psi(),x,x) +
     G0(a, b Ax) G2(a, b Ay) G0(a, b Az) 1/2 d(psi(),y,y) +
     G0(a, b Ax) G0(a, b Ay) G2(a, b Az) 1/2 d(psi(),z,z)

-- discard terms of order C epsilon^2

I3 = eval(I3,epsilon^(7/2),0)
\end{verbatim}}

\end{document}
