\input{preamble}

\section*{Harmonic oscillator action}

This is the Lagrangian for a harmonic oscillator.
\begin{equation*}
L=\frac{m}{2}(\dot x^2-\omega^2x^2)
\end{equation*}

Show that
\begin{equation*}
S=\int_0^TL\,dt=\frac{m\omega}{2\sin\omega T}
\left((x_b^2+x_a^2)\cos\omega T-2x_bx_a\right)
\end{equation*}

where $T=t_b-t_a$.

\bigskip
The first step is to derive $x(t)$ and $\dot x(t)$ from $L$ and the Euler-Lagrange equation
\begin{equation*}
\frac{d}{dt}\frac{\partial L}{\partial\dot x}=\frac{\partial L}{\partial x}
\end{equation*}

From $L$ we have
\begin{equation*}
\frac{d}{dt}\frac{\partial L}{\partial\dot x}=m\ddot x,\quad
\frac{\partial L}{\partial x}=-m\omega^2x
\end{equation*}

and by Euler-Lagrange
\begin{equation*}
\ddot x(t)=-\omega^2x
\tag{1}
\end{equation*}

The well-known solution to (1) is
\begin{equation*}
x(t)=A\sin(\omega t)+B\cos(\omega t)
\end{equation*}

We have the following boundary conditions.
\begin{equation*}
x(0)=x_a,\quad
x(T)=x_b
\tag{2}
\end{equation*}

Solve for $B$.
\begin{equation*}
B=x(0)=x_a
\end{equation*}

For $x(T)$ we have
\begin{equation*}
x(T)=A\sin(\omega T)+B\cos(\omega T)
\end{equation*}

Solve for $A$.
\begin{equation*}
A=\frac{x(T)-B\cos(\omega T)}{\sin(\omega T)}=
\frac{x_b-x_a\cos(\omega T)}{\sin(\omega T)}
\end{equation*}

Hence the equation of motion is
\begin{align*}
x(t)&=A\sin(\omega t)+B\cos(\omega t)
\\
&=\frac{x_b-x_a\cos(\omega T)}{\sin(\omega T)}\sin(\omega t)+x_a\cos(\omega t)
\tag{3}
\end{align*}

Differentiate $x(t)$ to obtain velocity $\dot x(t)$.
\begin{equation*}
\dot x(t)=\frac{d}{dt}x(t)=
\omega\left(
\frac{x_b-x_a\cos(\omega T)}{\sin(\omega T)}\cos(\omega t)-x_a\sin(\omega t)
\right)
\tag{4}
\end{equation*}

The action is
\begin{align*}
S&=\int_0^TL\,dt
\\
&=\frac{m}{2}\int_0^T (\dot{x}^2-\omega^2 x^2)\,dt
\\
&=\frac{m}{2}\left(
\int_0^T\dot{x}^2\,dt
-\int_0^T\omega^2x^2\,dt
\right)
\end{align*}

Use integration by parts to solve the first integral.
Let $u=v=\dot x$ so that
\begin{equation*}
\dot u=\ddot x,\quad
\int v\,dt=x
\end{equation*}

The integral transforms as
\begin{align*}
\int_0^T \dot x^2\,dt
&=\int_0^T uv\,dt
\\
&=\left(u\int v\,dt\right)\bigg|_0^T
-\int_0^T\dot u\left(\int v\,dt\right)\,dt
\\
&=\dot x(T)x(T)-\dot x(0)x(0)-\int_0^T \ddot xx\,dt
\end{align*}

Hence
\begin{equation*}
S=\frac{m}{2}\left(
\dot x(T)x(T)-\dot x(0)x(0)
-\int_0^T \ddot xx\,dt
-\int_0^T\omega^2x^2\,dt
\right)
\end{equation*}

The remaining integrals cancel by $\ddot x=-\omega^2x$ from equation (1) leaving
\begin{equation*}
S=\frac{m}{2}\bigl(\dot x(T)x(T)-\dot x(0)x(0)\bigr)
\tag{5}
\end{equation*}

From the boundary conditions (2)
\begin{equation*}
S=\frac{m}{2}\bigl(\dot x(T)x_b-\dot x(0)x_a\bigr)
\end{equation*}

From equation (3)
\begin{equation*}
\dot x(0)=\frac{\omega\bigl(x_b-x_a\cos(\omega T)\bigr)}{\sin(\omega T)}
\tag{6}
\end{equation*}

and
\begin{equation*}
\dot x(T)=\frac{\omega\bigl(x_b\cos(\omega T)-x_a\bigr)}{\sin(\omega T)}
\tag{7}
\end{equation*}

Hence
\begin{align*}
S&=\frac{m\omega}{2\sin(\omega T)}\Bigl[
\bigl(x_b\cos(\omega T)-x_a\bigr)x_b
-\bigl(x_b-x_a\cos(\omega T)\bigr)x_a
\Bigr]
\\
&=\frac{m\omega}{2\sin(\omega T)}
\left((x_b^2+x_a^2)\cos(\omega T)-2x_b x_a\right)
\tag{8}
\end{align*}

\end{document}
