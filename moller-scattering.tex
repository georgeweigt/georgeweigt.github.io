\documentclass[12pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath}
\usepackage{slashed}
\usepackage{tikz}
\parindent=0pt
\begin{document}

\section*{Moller scattering}
The following diagram shows the geometry of a Moller scattering experiment.
\begin{center}
\begin{tikzpicture}
\draw[dashed] (0,0) circle (0.5cm);
\draw[thick,->] (2,0) node[anchor=west] {$e^-$} -- (0.6,0);
\draw[thick,->] (-2,0) node[anchor=east] {$e^-$} -- (-0.6,0);
\draw[thick,->] (0.40,0.40) -- (1.3,1.3) node[anchor=south west] {$e^-$};
\draw[thick,->] (-0.4,-0.4) -- (-1.3,-1.3) node[anchor=north east] {$e^-$};
\draw (1,0.5) node {$\theta$};
\end{tikzpicture}
\end{center}

Here is the same diagram with momentum labels $p$ and Dirac spinor labels $u$.

\begin{center}
\begin{tikzpicture}
\draw[dashed] (0,0) circle (0.5cm);
\draw[thick,->] (2,0) node[anchor=west] {$p_2, u_{2b}$} -- (0.6,0);
\draw[thick,->] (-2,0) node[anchor=east] {$p_1, u_{1a}$} -- (-0.6,0);
\draw[thick,->] (0.40,0.40) -- (1.3,1.3) node[anchor=south west] {$p_3, u_{3c}$};
\draw[thick,->] (-0.4,-0.4) -- (-1.3,-1.3) node[anchor=north east] {$p_4, u_{4d}$};
\draw (1,0.5) node {$\theta$};
\end{tikzpicture}
\end{center}

In center of mass coordinates the momentum vectors are
\begin{align*}
p_1&=
\underset{\text{electron 1}}
{
\begin{pmatrix}E\\0\\0\\p\end{pmatrix}
}
&
p_2&=
\underset{\text{electron 2}}
{
\begin{pmatrix}E\\0\\0\\-p\end{pmatrix}
}
&
p_3&=
\underset{\text{electron 3}}
{
\begin{pmatrix}
E\\
p\sin\theta\cos\phi\\
p\sin\theta\sin\phi\\
p\cos\theta
\end{pmatrix}
}
&
p_4&=
\underset{\text{electron 4}}
{
\begin{pmatrix}
E\\
-p\sin\theta\cos\phi\\
-p\sin\theta\sin\phi\\
-p\cos\theta
\end{pmatrix}
}
\end{align*}

Symbol $p$ is incident momentum.
Symbol $E$ is total energy $E=\sqrt{p^2+m^2}$ where $m$ is electron mass.
Polar angle $\theta$ is the observed scattering angle.
Azimuth angle $\phi$ cancels out in scattering calculations.

\bigskip
The spinors are
\begin{align*}
u_{11}&=
\underset{\substack{\text{electron 1}\\\text{spin up}}}
{\begin{pmatrix}E+m\\0\\p\\0\end{pmatrix}}
&
u_{21}&=
\underset{\substack{\text{electron 2}\\\text{spin up}}}
{\begin{pmatrix}E+m\\0\\-p\\0\end{pmatrix}}
&
u_{31}&=
\underset{\substack{\text{electron 3}\\\text{spin up}}}
{\begin{pmatrix}E+m\\0\\p_{3z}\\p_{3x}+ip_{3y}\end{pmatrix}}
&
u_{41}&=
\underset{\substack{\text{electron 4}\\\text{spin up}}}
{\begin{pmatrix}E+m\\0\\p_{4z}\\p_{4x}+ip_{4y}\end{pmatrix}}
\\[1ex]
u_{12}&=
\underset{\substack{\text{electron 1}\\\text{spin down}}}
{
\begin{pmatrix}0\\E+m\\0\\-p\end{pmatrix}
}
&
u_{22}&=
\underset{\substack{\text{electron 2}\\\text{spin down}}}
{
\begin{pmatrix}0\\E+m\\0\\p\end{pmatrix}
}
&
u_{32}&=
\underset{\substack{\text{electron 3}\\\text{spin down}}}
{
\begin{pmatrix}0\\E+m\\p_{3x}-ip_{3y}\\-p_{3z}\end{pmatrix}
}
&
u_{42}&=
\underset{\substack{\text{electron 4}\\\text{spin down}}}
{
\begin{pmatrix}0\\E+m\\p_{4x}-ip_{4y}\\-p_{4z}\end{pmatrix}
}
\end{align*}

Spinor subscripts have 1 for spin up and 2 for spin down.
The spinors are not individually normalized.
Instead, a combined spinor normalization constant $N=(E+m)^4$ will be used.

\bigskip
This is the probability density for spin state $abcd$.
The formula is derived from Feynman diagrams for Moller scattering.
\begin{equation*}
|\mathcal{M}_{abcd}|^2=\frac{e^4}{N}
\bigg|
\underset{\substack{\\[1ex]\text{no electron interchange}}}
{\frac{1}{t}(\bar{u}_{3c}\gamma^\mu u_{1a})(\bar{u}_{4d}\gamma_\mu u_{2b})}
-
\underset{\substack{\\[1ex]\text{electron interchange}}}
{\frac{1}{u}(\bar{u}_{4d}\gamma^\nu u_{1a})(\bar{u}_{3c}\gamma_\nu u_{2b})}
\bigg|^2
\end{equation*}

Symbol $e$ is electron charge.
Symbols $t$ and $u$ are Mandelstam variables
\begin{align*}
t&=(p_1-p_3)^2
\\
u&=(p_1-p_4)^2
\end{align*}

Let
\begin{equation*}
a_1=(\bar{u}_{3c}\gamma^\mu u_{1a})(\bar{u}_{4d}\gamma_\mu u_{2b}),
\quad
a_2=(\bar{u}_{4d}\gamma^\nu u_{1a})(\bar{u}_{3c}\gamma_\nu u_{2b})
\end{equation*}

Then
\begin{align*}
|\mathcal{M}_{abcd}|^2
&=
\frac{e^4}{N}
\left|\frac{a_1}{t} - \frac{a_2}{u}\right|^2\\
&=
\frac{e^4}{N}
\left(\frac{a_1}{t} - \frac{a_2}{u}\right)\left(\frac{a_1}{t} - \frac{a_2}{u}\right)^*\\
&=
\frac{e^4}{N}
\left(
\frac{a_1a_1^*}{t^2} - \frac{a_1a_2^*}{tu} -
\frac{a_1^*a_2}{tu} + \frac{a_2a_2^*}{u^2}
\right)
\end{align*}

The expected probability density $\langle|\mathcal{M}|^2\rangle$ is computed by
summing $|\mathcal{M}_{abcd}|^2$ over all spin states and dividing by the number
of inbound states.
There are four inbound states.
\begin{align*}
\langle|\mathcal{M}|^2\rangle
&=
\frac{1}{4}\sum_{a=1}^2\sum_{b=1}^2\sum_{c=1}^2\sum_{d=1}^2
|\mathcal{M}_{abcd}|^2\\
&=
\frac{e^4}{4N}\sum_{a=1}^2\sum_{b=1}^2\sum_{c=1}^2\sum_{d=1}^2
\left(
\frac{a_1a_1^*}{t^2}-\frac{a_1a_2^*}{tu}-\frac{a_1^*a_2}{tu}+\frac{a_2a_2^*}{u^2}
\right)
\end{align*}

The Casimir trick uses matrix products to compute sums over spins.
\begin{align*}
f_{11}&=\frac{1}{N}\sum_{abcd}a_1a_1^*=
\mathop{\rm Tr}\left(
(\slashed{p}_3+m)\gamma^\mu(\slashed{p}_1+m)\gamma^\nu
\right)
\mathop{\rm Tr}\left(
(\slashed{p}_4+m)\gamma_\mu(\slashed{p}_2+m)\gamma_\nu
\right)
\\
f_{12}&=\frac{1}{N}\sum_{abcd}a_1a_2^*=
\mathop{\rm Tr}\left(
(\slashed{p}_3+m)\gamma^\mu(\slashed{p}_1+m)\gamma^\nu
(\slashed{p}_4+m)\gamma_\mu(\slashed{p}_2+m)\gamma_\nu
\right)
\\
f_{22}&=\frac{1}{N}\sum_{abcd}a_2a_2^*=
\mathop{\rm Tr}\left(
(\slashed{p}_4+m)\gamma^\mu(\slashed{p}_1+m)\gamma^\nu
\right)
\mathop{\rm Tr}\left(
(\slashed{p}_3+m)\gamma_\mu(\slashed{p}_2+m)\gamma_\nu
\right)
\end{align*}

Hence
\begin{equation*}
\langle|\mathcal{M}|^2\rangle
=\frac{e^4}{4}
\left(
\frac{f_{11}}{t^2}-\frac{f_{12}}{tu}-\frac{f_{12}^*}{tu}+\frac{f_{22}}{u^2}
\right)
\end{equation*}

The following formulas are equivalent to the Casimir trick.
(Recall that $a\cdot b=a^\mu g_{\mu\nu}b^\nu$)
\begin{align*}
f_{11}&=
32 (p_1\cdot p_2)^2 +
32 (p_1\cdot p_4)^2 -
64 m^2 (p_1\cdot p_3) + 64 m^4
\\
f_{12}&=
-32 (p_1\cdot p_2)^2 +
32 m^2 (p_1\cdot p_2) +
32 m^2 (p_1\cdot p_3) +
32 m^2 (p_1\cdot p_4) - 32m^4
\\
f_{22}&=
32 (p_1\cdot p_2)^2 +
32 (p_1\cdot p_3)^2 -
64 m^2 (p_1\cdot p_4) + 64 m^4
\end{align*}

In Mandelstam variables
\begin{align*}
s&=(p_1+p_2)^2
\\
t&=(p_1-p_3)^2
\\
u&=(p_1-p_4)^2
\end{align*}
the formulas are
\begin{align*}
f_{11} &= 8 s^2 + 8 u^2 - 64 s m^2 - 64 u m^2 + 192 m^4
\\
f_{12} &= -8 s^2 + 64 s m^2 - 96 m^4
\\
f_{22} &= 8 s^2 + 8 t^2 - 64 s m^2 - 64 t m^2 + 192 m^4
\end{align*}

\subsection*{High energy approximation}
When $E\gg m$ a useful approximation is to set $m=0$ and obtain
\begin{align*}
f_{11}&=8s^2+8u^2\\
f_{12}&=-8s^2\\
f_{22}&=8s^2+8t^2
\end{align*}

Hence
\begin{align*}
\langle|\mathcal{M}|^2\rangle
&=\frac{e^4}{4}
\left(
\frac{f_{11}}{t^2}-\frac{f_{12}}{tu}-\frac{f_{12}^*}{tu}+\frac{f_{22}}{u^2}
\right)
\\
&=\frac{e^4}{4}
\left(
\frac{8s^2+8u^2}{t^2}-\frac{-8s^2}{tu}-\frac{-8s^2}{tu}+\frac{8s^2+8t^2}{u^2}
\right)
\\
&=2e^4
\left(
\frac{s^2+u^2}{t^2}+\frac{2s^2}{tu}+\frac{s^2+t^2}{u^2}
\right)
\end{align*}

Combine terms so $\langle|\mathcal{M}|^2\rangle$ has a common denominator.
\begin{equation*}
\langle|\mathcal{M}|^2\rangle
=2e^4
\left(
\frac{u^2(s^2+u^2)+2s^2tu+t^2(s^2+t^2)}{t^2u^2}
\right)
\end{equation*}

For $m=0$ the Mandelstam variables are
\begin{align*}
s&=4E^2
\\
t&=2E^2(\cos\theta-1)
\\
u&=-2E^2(\cos\theta+1)
\end{align*}

Hence
\begin{align*}
\langle|\mathcal{M}|^2\rangle
&=2e^4
\left(
\frac{32E^8\cos^4\theta+192E^8\cos^2\theta+288E^8}{16E^8(\cos\theta-1)^2(\cos\theta+1)^2}
\right)
\\
&=4e^4\frac{\left(\cos^2\theta+3\right)^2}{(\cos\theta-1)^2(\cos\theta+1)^2}
\\
&=4e^4
\frac{(\cos^2\theta+3)^2}{\sin^4\theta}
\end{align*}

The following equivalent formula can also be used.
\begin{multline*}
\langle|\mathcal{M}|^2\rangle
=2e^4
\left(
\frac{s^2+u^2}{t^2}+\frac{2s^2}{tu}+\frac{s^2+t^2}{u^2}
\right)
\\
=2e^4\bigg(
\underset{\substack{\\[1ex]\text{no electron interchange}}}
{\frac{1+\cos^4(\theta/2)}{\sin^4(\theta/2)}}
+
\underset{\substack{\\[1ex]\text{interaction term}}}
{\frac{2}{\sin^2(\theta/2)\cos^2(\theta/2)}}
+
\underset{\substack{\\[1ex]\text{electron interchange}}}
{\frac{1+\sin^4(\theta/2)}{\cos^4(\theta/2)}}
\bigg)
\end{multline*}

\subsection*{Cross section}
The differential cross section is
\begin{equation*}
\frac{d\sigma}{d\Omega}
=\frac{\langle|\mathcal{M}|^2\rangle}{256\pi^2E^2}
=\frac{e^4}{64\pi^2E^2}
\frac{(\cos^2\theta+3)^2}{\sin^4\theta},
\quad E\gg m
\end{equation*}

Substituting $e^4=16\pi^2\alpha^2$ yields
\begin{equation*}
\frac{d\sigma}{d\Omega}=\frac{\alpha^2}{4E^2}
\frac{(\cos^2\theta+3)^2}{\sin^4\theta}
\end{equation*}

We can integrate $d\sigma$ to obtain a cumulative distribution function.
Recall that
\begin{equation*}
d\Omega=\sin\theta\,d\theta\,d\phi
\end{equation*}

Hence
\begin{equation*}
d\sigma=\frac{\alpha^2}{4E^2}
\frac{\left(\cos^2\theta+3\right)^2}{\sin^4\theta}\sin\theta\,d\theta\,d\phi
\end{equation*}

Let $I(\theta)$ be the following integral of $d\sigma$.
\begin{equation*}
I(\theta)=\int\frac{\left(\cos^2\theta+3\right)^2}{\sin^4\theta}\sin\theta\,d\theta
=-\frac{8\cos\theta}{\sin^2\theta}-\cos\theta
\end{equation*}

The cumulative distribution function is
\begin{equation*}
F(\theta)=\frac{I(\theta)-I(a)}{I(\pi-a)-I(a)},
\quad
a\le\theta\le\pi-a
\end{equation*}

Angular support is limited to an arbitrary $a>0$ because $I(0)$ and $I(\pi)$ are undefined.

\bigskip
The probability of observing scattering events in the interval $\theta_1$ to $\theta_2$ is
\begin{equation*}
P(\theta_1\le\theta\le\theta_2)=F(\theta_2)-F(\theta_1)
\end{equation*}

\subsection*{Notes}
1. A.~Zee page 134 has the cross section
\begin{equation*}
\frac{d\sigma}{d\Omega}=\bigg(\frac{e^2}{4\pi}\bigg)^2\frac{1}{8E^2}f(\theta)
\end{equation*}
where $f(\theta)$ is the probability density function
\begin{equation*}
f(\theta)=
\frac{1+\cos^4(\theta/2)}{\sin^4(\theta/2)}
+\frac{2}{\sin^2(\theta/2)\cos^2(\theta/2)}
+\frac{1+\sin^4(\theta/2)}{\cos^4(\theta/2)}
\end{equation*}

Probability density $f(\theta)$ is equivalent to
\begin{equation*}
f(\theta)=\frac{2(\cos^2\theta+3)^2}{\sin^4\theta}
\end{equation*}

Noting that
\begin{equation*}
e^4=16\pi^2\alpha^2
\end{equation*}
we have
\begin{equation*}
\bigg(\frac{e^2}{4\pi}\bigg)^2=\alpha^2
\end{equation*}

Hence
\begin{equation*}
\frac{d\sigma}{d\Omega}=\frac{\alpha^2}{4E^2}\frac{(\cos^2\theta+3)^2}{\sin^4\theta}
\end{equation*}

2. In component notation, the trace operators of the Casimir trick become sums over
a repeated index, in this case $\alpha$.
\begin{align*}
f_{11}&=
\left(
(\slashed{p}_3+m)^\alpha{}_\beta
\gamma^{\mu\beta}{}_\rho
(\slashed{p}_1+m)^\rho{}_\sigma
\gamma^{\nu\sigma}{}_\alpha
\right)
\left(
(\slashed{p}_4+m)^\alpha{}_\beta
\gamma_\mu{}^\beta{}_\rho
(\slashed{p}_2+m)^\rho{}_\sigma
\gamma_\nu{}^\sigma{}_\alpha
\right)
\\
f_{12}&=
(\slashed{p}_3+m)^\alpha{}_\beta
\gamma^{\mu\beta}{}_\rho
(\slashed{p}_1+m)^\rho{}_\sigma
\gamma^{\nu\sigma}{}_\tau
(\slashed{p}_4+m)^\tau{}_\delta
\gamma_\mu{}^\delta{}_\eta
(\slashed{p}_2+m)^\eta{}_\xi
\gamma_\nu{}^\xi{}_\alpha
\\
f_{22}&=
\left(
(\slashed{p}_4+m)^\alpha{}_\beta
\gamma^{\mu\beta}{}_\rho
(\slashed{p}_1+m)^\rho{}_\sigma
\gamma^{\nu\sigma}{}_\alpha
\right)
\left(
(\slashed{p}_3+m)^\alpha{}_\beta
\gamma_\mu{}^\beta{}_\rho
(\slashed{p}_2+m)^\rho{}_\sigma
\gamma_\nu{}^\sigma{}_\alpha
\right)
\end{align*}

To convert the above formulas to Eigenmath code,
the $\gamma$ tensors need to be transposed
so that repeated indices are adjacent to each other.
Also, multiply $\gamma^\mu$ by the metric tensor to lower the index.
\begin{align*}
\gamma^{\beta\mu}{}_\rho\quad&\rightarrow\quad
\text{\tt gammaT = transpose(gamma)}\\
\gamma^\beta{}_{\mu\rho}\quad&\rightarrow\quad
\text{\tt gammaL = transpose(dot(gmunu,gamma))}
\end{align*}

Define the following $4\times4$ matrices.
\begin{align*}
(\slashed{p}_1+m)\quad&\rightarrow\quad\text{\tt X1 = pslash1 + m I}\\
(\slashed{p}_2+m)\quad&\rightarrow\quad\text{\tt X2 = pslash2 + m I}\\
(\slashed{p}_3+m)\quad&\rightarrow\quad\text{\tt X3 = pslash3 + m I}\\
(\slashed{p}_4+m)\quad&\rightarrow\quad\text{\tt X4 = pslash4 + m I}
\end{align*}

Then for $f_{11}$ we have the following Eigenmath code.
The contract function sums over $\alpha$.
\begin{align*}
(\slashed{p}_3+m)^\alpha{}_\beta
\gamma^{\mu\beta}{}_\rho
(\slashed{p}_1+m)^\rho{}_\sigma
\gamma^{\nu\sigma}{}_\alpha
\quad&\rightarrow\quad
\text{\tt T1 = contract(dot(X3,gammaT,X1,gammaT),1,4)}
\\
(\slashed{p}_4+m)^\alpha{}_\beta
\gamma_\mu{}^\beta{}_\rho
(\slashed{p}_2+m)^\rho{}_\sigma
\gamma_\nu{}^\sigma{}_\alpha
\quad&\rightarrow\quad
\text{\tt T2 = contract(dot(X4,gammaL,X2,gammaL),1,4)}
\end{align*}

Next, multiply then sum over repeated indices.
The dot function sums over $\nu$ then the contract function
sums over $\mu$. The transpose makes the $\nu$ indices adjacent
as required by the dot function.
$$
f_{11}=
\mathop{\rm Tr}(\cdots\gamma^\mu\cdots\gamma^\nu)
\mathop{\rm Tr}(\cdots\gamma_\mu\cdots\gamma_\nu)
\quad\rightarrow\quad
\text{\tt contract(dot(T1,transpose(T2)))}
$$

Follow suit for $f_{22}$.
\begin{align*}
(\slashed{p}_4+m)^\alpha{}_\beta
\gamma^{\mu\beta}{}_\rho
(\slashed{p}_1+m)^\rho{}_\sigma
\gamma^{\nu\sigma}{}_\alpha
\quad&\rightarrow\quad
\text{\tt T1 = contract(dot(X4,gammaT,X1,gammaT),1,4)}
\\
(\slashed{p}_3+m)^\alpha{}_\beta
\gamma_\mu{}^\beta{}_\rho
(\slashed{p}_2+m)^\rho{}_\sigma
\gamma_\nu{}^\sigma{}_\alpha
\quad&\rightarrow\quad
\text{\tt T2 = contract(dot(X3,gammaL,X2,gammaL),1,4)}
\end{align*}

Then
$$
f_{22}=
\mathop{\rm Tr}(\cdots\gamma^\mu\cdots\gamma^\nu)
\mathop{\rm Tr}(\cdots\gamma_\mu\cdots\gamma_\nu)
\quad\rightarrow\quad
\text{\tt contract(dot(T1,transpose(T2)))}
$$

The calculation of $f_{12}$ begins with
\begin{multline*}
(\slashed{p}_3+m)^\alpha{}_\beta
\gamma^{\mu\beta}{}_\rho
(\slashed{p}_1+m)^\rho{}_\sigma
\gamma^{\nu\sigma}{}_\tau
(\slashed{p}_4+m)^\tau{}_\delta
\gamma_\mu{}^\delta{}_\eta
(\slashed{p}_2+m)^\eta{}_\xi
\gamma_\nu{}^\xi{}_\alpha
\\
\rightarrow\quad
\text{\tt T = contract(dot(X3,gammaT,X1,gammaT,X4,gammaL,X2,gammaL),1,6)}
\end{multline*}

Then sum over repeated indices $\mu$ and $\nu$.
$$
f_{12}=\mathop{\rm Tr}(\cdots\gamma^\mu\cdots\gamma^\nu\cdots\gamma_\mu\cdots\gamma_\nu)
\quad\rightarrow\quad
\text{\tt contract(contract(T,1,3))}
$$

\end{document}
