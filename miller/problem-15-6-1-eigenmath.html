<html><body><script src='https://georgeweigt.github.io/eigenmath.js'></script><textarea id='stdin' rows='24' cols='80' style='font-family:courier;font-size:12pt'>
"Problem 15.6.1"

ahat(f) = sqrt(1/2) (f xi + d(f,xi))
adag(f) = sqrt(1/2) (f xi - d(f,xi))

ket0 = pi^(-1/4) exp(-xi^2 / 2) -- see equation (15.33)

ket(n) = test(n == 0, ket0, sqrt(1/n) adag(ket(n - 1)))

psi(n) = sqrt(nbar^n exp(-nbar) / n!) exp(-i (n + 1/2) omega t) ket(n)

-- use N instead of infinity

N = 10

Psi = sum(n,0,N,psi(n))

U = ahat(Psi)
V = sqrt(nbar) exp(-i omega t) Psi

-- correction for finite N

V = V - sqrt(nbar) exp(-i omega t) psi(N)

check(U == V)

"ok"
</textarea><button onclick='run()'>Run</button><p><div id='stdout'></div></body></html>
