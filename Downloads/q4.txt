-- eigenmath.org/Downloads/q4.txt

ket0000 = (1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
ket0001 = (0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
ket0010 = (0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0)
ket0011 = (0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0)
ket0100 = (0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0)
ket0101 = (0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0)
ket0110 = (0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0)
ket0111 = (0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0)
ket1000 = (0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0)
ket1001 = (0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0)
ket1010 = (0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0)
ket1011 = (0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0)
ket1100 = (0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0)
ket1101 = (0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0)
ket1110 = (0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0)
ket1111 = (0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1)

H0 = (ket0000 + ket1000,
      ket0001 + ket1001,
      ket0010 + ket1010,
      ket0011 + ket1011,
      ket0100 + ket1100,
      ket0101 + ket1101,
      ket0110 + ket1110,
      ket0111 + ket1111,
      ket0000 - ket1000,
      ket0001 - ket1001,
      ket0010 - ket1010,
      ket0011 - ket1011,
      ket0100 - ket1100,
      ket0101 - ket1101,
      ket0110 - ket1110,
      ket0111 - ket1111) / sqrt(2)

H1 = (ket0000 + ket0100,
      ket0001 + ket0101,
      ket0010 + ket0110,
      ket0011 + ket0111,
      ket0000 - ket0100,
      ket0001 - ket0101,
      ket0010 - ket0110,
      ket0011 - ket0111,
      ket1000 + ket1100,
      ket1001 + ket1101,
      ket1010 + ket1110,
      ket1011 + ket1111,
      ket1000 - ket1100,
      ket1001 - ket1101,
      ket1010 - ket1110,
      ket1011 - ket1111) / sqrt(2)

H2 = (ket0000 + ket0010,
      ket0001 + ket0011,
      ket0000 - ket0010,
      ket0001 - ket0011,
      ket0100 + ket0110,
      ket0101 + ket0111,
      ket0100 - ket0110,
      ket0101 - ket0111,
      ket1000 + ket1010,
      ket1001 + ket1011,
      ket1000 - ket1010,
      ket1001 - ket1011,
      ket1100 + ket1110,
      ket1101 + ket1111,
      ket1100 - ket1110,
      ket1101 - ket1111) / sqrt(2)

H3 = (ket0000 + ket0001,
      ket0000 - ket0001,
      ket0010 + ket0011,
      ket0010 - ket0011,
      ket0100 + ket0101,
      ket0100 - ket0101,
      ket0110 + ket0111,
      ket0110 - ket0111,
      ket1000 + ket1001,
      ket1000 - ket1001,
      ket1010 + ket1011,
      ket1010 - ket1011,
      ket1100 + ket1101,
      ket1100 - ket1101,
      ket1110 + ket1111,
      ket1110 - ket1111) / sqrt(2)

X0 = (ket1000,
      ket1001,
      ket1010,
      ket1011,
      ket1100,
      ket1101,
      ket1110,
      ket1111,
      ket0000,
      ket0001,
      ket0010,
      ket0011,
      ket0100,
      ket0101,
      ket0110,
      ket0111)

X1 = (ket0100,
      ket0101,
      ket0110,
      ket0111,
      ket0000,
      ket0001,
      ket0010,
      ket0011,
      ket1100,
      ket1101,
      ket1110,
      ket1111,
      ket1000,
      ket1001,
      ket1010,
      ket1011)

X2 = (ket0010,
      ket0011,
      ket0000,
      ket0001,
      ket0110,
      ket0111,
      ket0100,
      ket0101,
      ket1010,
      ket1011,
      ket1000,
      ket1001,
      ket1110,
      ket1111,
      ket1100,
      ket1101)

X3 = (ket0001,
      ket0000,
      ket0011,
      ket0010,
      ket0101,
      ket0100,
      ket0111,
      ket0110,
      ket1001,
      ket1000,
      ket1011,
      ket1010,
      ket1101,
      ket1100,
      ket1111,
      ket1110)

C01 = (ket0000,
       ket0001,
       ket0010,
       ket0011,
       ket0100,
       ket0101,
       ket0110,
       ket0111,
       ket1100,
       ket1101,
       ket1110,
       ket1111,
       ket1000,
       ket1001,
       ket1010,
       ket1011)

C02 = (ket0000,
       ket0001,
       ket0010,
       ket0011,
       ket0100,
       ket0101,
       ket0110,
       ket0111,
       ket1010,
       ket1011,
       ket1000,
       ket1001,
       ket1110,
       ket1111,
       ket1100,
       ket1101)

C03 = (ket0000,
       ket0001,
       ket0010,
       ket0011,
       ket0100,
       ket0101,
       ket0110,
       ket0111,
       ket1001,
       ket1000,
       ket1011,
       ket1010,
       ket1101,
       ket1100,
       ket1111,
       ket1110)

C10 = (ket0000,
       ket0001,
       ket0010,
       ket0011,
       ket1100,
       ket1101,
       ket1110,
       ket1111,
       ket1000,
       ket1001,
       ket1010,
       ket1011,
       ket0100,
       ket0101,
       ket0110,
       ket0111)

C12 = (ket0000,
       ket0001,
       ket0010,
       ket0011,
       ket0110,
       ket0111,
       ket0100,
       ket0101,
       ket1000,
       ket1001,
       ket1010,
       ket1011,
       ket1110,
       ket1111,
       ket1100,
       ket1101)

C13 = (ket0000,
       ket0001,
       ket0010,
       ket0011,
       ket0101,
       ket0100,
       ket0111,
       ket0110,
       ket1000,
       ket1001,
       ket1010,
       ket1011,
       ket1101,
       ket1100,
       ket1111,
       ket1110)

C20 = (ket0000,
       ket0001,
       ket1010,
       ket1011,
       ket0100,
       ket0101,
       ket1110,
       ket1111,
       ket1000,
       ket1001,
       ket0010,
       ket0011,
       ket1100,
       ket1101,
       ket0110,
       ket0111)

C21 = (ket0000,
       ket0001,
       ket0110,
       ket0111,
       ket0100,
       ket0101,
       ket0010,
       ket0011,
       ket1000,
       ket1001,
       ket1110,
       ket1111,
       ket1100,
       ket1101,
       ket1010,
       ket1011)

C23 = (ket0000,
       ket0001,
       ket0011,
       ket0010,
       ket0100,
       ket0101,
       ket0111,
       ket0110,
       ket1000,
       ket1001,
       ket1011,
       ket1010,
       ket1100,
       ket1101,
       ket1111,
       ket1110)

C30 = (ket0000,
       ket1001,
       ket0010,
       ket1011,
       ket0100,
       ket1101,
       ket0110,
       ket1111,
       ket1000,
       ket0001,
       ket1010,
       ket0011,
       ket1100,
       ket0101,
       ket1110,
       ket0111)

C31 = (ket0000,
       ket0101,
       ket0010,
       ket0111,
       ket0100,
       ket0001,
       ket0110,
       ket0011,
       ket1000,
       ket1101,
       ket1010,
       ket1111,
       ket1100,
       ket1001,
       ket1110,
       ket1011)

C32 = (ket0000,
       ket0011,
       ket0010,
       ket0001,
       ket0100,
       ket0111,
       ket0110,
       ket0101,
       ket1000,
       ket1011,
       ket1010,
       ket1001,
       ket1100,
       ket1111,
       ket1110,
       ket1101)

M(psi,v,k,x) = do(
  v = zero(16),
  for(k,1,16,v[k] = conj(psi[k]) psi[k]),
  xrange = (0,16),
  yrange = (0,1),
  draw(v[ceiling(x)],x)
)
