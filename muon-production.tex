\documentclass[12pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath}
\usepackage{slashed}
\usepackage{tikz}
\parindent=0pt
\begin{document}

\section*{Muon pair production}
A high energy electron and positron collision can create two muons.
\begin{center}
\begin{tikzpicture}
\draw[dashed] (0,0) circle (0.5cm);
\draw[thick,->] (2,0) node[anchor=west] {$e^+$} -- (0.6,0);
\draw[thick,->] (-2,0) node[anchor=east] {$e^-$} -- (-0.6,0);
\draw[thick,->] (0.40,0.40) -- (1.3,1.3) node[anchor=south west] {$\mu^-$};
\draw[thick,->] (-0.4,-0.4) -- (-1.3,-1.3) node[anchor=north east] {$\mu^+$};
\draw (1,0.5) node {$\theta$};
\end{tikzpicture}
\end{center}

Here is the same diagram with momentum and spinor labels.
\begin{center}
\begin{tikzpicture}
\draw[dashed] (0,0) circle (0.5cm);
\draw[thick,->] (2,0) node[anchor=west] {$p_2, v_2$} -- (0.6,0);
\draw[thick,->] (-2,0) node[anchor=east] {$p_1, u_1$} -- (-0.6,0);
\draw[thick,->] (0.40,0.40) -- (1.3,1.3) node[anchor=south west] {$p_3, u_3$};
\draw[thick,->] (-0.4,-0.4) -- (-1.3,-1.3) node[anchor=north east] {$p_4, v_4$};
\draw (1,0.5) node {$\theta$};
\end{tikzpicture}
\end{center}

In a typical collider experiment the momentum vectors are
\begin{align*}
p_1&=
\underset{\text{inbound electron}}
{
\begin{pmatrix}E\\0\\0\\p\end{pmatrix}
}
&
p_2&=
\underset{\text{inbound positron}}
{
\begin{pmatrix}E\\0\\0\\-p\end{pmatrix}
}
&
p_3&=
\underset{\text{outbound muon}}
{
\begin{pmatrix}
E\\
\rho\sin\theta\cos\phi\\
\rho\sin\theta\sin\phi\\
\rho\cos\theta
\end{pmatrix}
}
&
p_4&=
\underset{\text{outbound anti-muon}}
{
\begin{pmatrix}
E\\
-\rho\sin\theta\cos\phi\\
-\rho\sin\theta\sin\phi\\
-\rho\cos\theta
\end{pmatrix}
}
\end{align*}

Symbol $E$ is beam energy, $p=\sqrt{E^2-m^2}$, $\rho=\sqrt{E^2-M^2}$,
$m$ is electron mass $0.51\,\text{MeV}$,
and $M$ is muon mass $106\,\text{MeV}$.

\bigskip
The spinors are
\begin{align*}
u_{11}&=
\underset{\substack{\text{inbound electron}\\\text{spin up}}}
{
\begin{pmatrix}E+m\\0\\p\\0\end{pmatrix}
}
&
v_{21}&=
\underset{\substack{\text{inbound positron}\\\text{spin up}}}
{
\begin{pmatrix}-p\\0\\E+m\\0\end{pmatrix}
}
&
u_{31}&=
\underset{\substack{\text{outbound muon}\\\text{spin up}}}
{
\begin{pmatrix}E+M\\0\\p_3^z\\p_3^x+ip_3^y\end{pmatrix}
}
&
v_{41}&=
\underset{\substack{\text{outbound anti-muon}\\\text{spin up}}}
{
\begin{pmatrix}p_4^z\\p_4^x+ip_4^y\\E+M\\0\end{pmatrix}
}
\\[1ex]
u_{12}&=
\underset{\substack{\text{inbound electron}\\\text{spin down}}}
{
\begin{pmatrix}0\\E+m\\0\\-p\end{pmatrix}
}
&
v_{22}&=
\underset{\substack{\text{inbound positron}\\\text{spin down}}}
{
\begin{pmatrix}0\\p\\0\\E+m\end{pmatrix}
}
&
u_{32}&=
\underset{\substack{\text{outbound muon}\\\text{spin down}}}
{
\begin{pmatrix}0\\E+M\\p_3^x-ip_3^y\\-p_3^z\end{pmatrix}
}
&
v_{42}&=
\underset{\substack{\text{outbound anti-muon}\\\text{spin down}}}
{
\begin{pmatrix}p_4^x-ip_4^y\\-p_4^z\\0\\E+M\end{pmatrix}
}
\end{align*}

Spinor subscripts have 1 for spin up and 2 for spin down.
The spinors are not individually normalized.
Instead, a combined spinor normalization constant $N=(E+m)^2(E+M)^2$ will be used.

\bigskip
This is the probability density for spin state $abcd$.
Symbol $e$ is electron charge and $s=(p_1+p_2)^2=4E^2$.
The formula is derived from Feynman diagrams for muon pair production.
\begin{equation*}
\big|\mathcal{M}_{abcd}\big|^2
=\frac{e^4}{Ns^2}\big|(\bar{u}_{3c}\gamma_\mu v_{4d})(\bar{v}_{2b}\gamma^\mu u_{1a})\big|^2
\end{equation*}

The expected probability density $\langle|\mathcal{M}|^2\rangle$
is computed by summing $|\mathcal{M}_{abcd}|^2$ over all spin states
and dividing by the number of inbound states.
There are four inbound states.
\begin{align*}
\langle|\mathcal{M}|^2\rangle
&=\frac{1}{4}\sum_{a=1}^2\sum_{b=1}^2\sum_{c=1}^2\sum_{d=1}^2\big|\mathcal{M}_{abcd}\big|^2
\\
&=\frac{e^4}{4Ns^2}\sum_{a=1}^2\sum_{b=1}^2\sum_{c=1}^2\sum_{d=1}^2
\big|(\bar{u}_{3c}\gamma_\mu v_{4d})(\bar{v}_{2b}\gamma^\mu u_{1a})\big|^2
\end{align*}

The Casimir trick uses matrix arithmetic to compute sums.
\begin{equation*}
\langle|\mathcal{M}|^2\rangle
=\frac{e^4}{4s^2}
\mathop{\rm Tr}\left((\slashed{p}_3+M)\gamma^\mu(\slashed{p}_4-M)\gamma^\nu\right)
\mathop{\rm Tr}\left((\slashed{p}_2-m)\gamma_\mu(\slashed{p}_1+m)\gamma_\nu\right)
\end{equation*}

The following formula is equivalent to the Casimir trick.
(Recall that $a\cdot b=a^\mu g_{\mu\nu}b^\nu$)
\begin{multline*}
\langle|\mathcal{M}|^2\rangle
=\frac{e^4}{4s^2}
\bigg(
32 (p_1\cdot p_3) (p_2\cdot p_4) +
32 (p_1\cdot p_4) (p_2\cdot p_3)
\\
{}+32 m^2 (p_3\cdot p_4) +
32 M^2 (p_1\cdot p_2) +
64 m^2 M^2
\bigg)
\end{multline*}

For the momentum vectors given above the result is
\begin{equation*}
\langle|\mathcal{M}|^2\rangle
=e^4\left(1+\cos^2\theta+\frac{m^2+M^2}{E^2}\sin^2\theta+\frac{m^2M^2}{E^4}\cos^2\theta\right)
\end{equation*}

\subsection*{Cross section}
The differential cross section is
\begin{equation*}
\frac{d\sigma}{d\Omega}
=\frac{\langle|\mathcal{M}|^2\rangle}{4(4\pi\varepsilon_0)^2s}
\end{equation*}

For high energy experiments a useful approximation is
\begin{equation*}
\langle|\mathcal{M}|^2\rangle=e^4\left(1+\cos^2\theta\right)
\quad\text{and}\quad
s=4E^2
\end{equation*}

Substitute for $\langle|\mathcal{M}|^2\rangle$.
\begin{equation*}
\frac{d\sigma}{d\Omega}=\frac{e^4}{4(4\pi\varepsilon_0)^2s}\left(1+\cos^2\theta\right)
\end{equation*}

Noting that
\begin{equation*}
e^2=4\pi\varepsilon_0\alpha\hbar c
\end{equation*}
we can also write
\begin{equation*}
\frac{d\sigma}{d\Omega}=\frac{\alpha^2(\hbar c)^2}{4s}\left(1+\cos^2\theta\right)
\end{equation*}

We can integrate $d\sigma$ to obtain a cumulative distribution function.
Let $I(\theta)$ be the following integral of $d\sigma$.
\begin{equation*}
I(\theta)=\int\left(1+\cos^2\theta\right)\sin\theta\,d\theta
\end{equation*}

The result is
\begin{equation*}
I(\theta)=-\frac{\cos^3\theta}{3}-\cos\theta
\end{equation*}

The cumulative distribution function is
\begin{equation*}
F(\theta)=\frac{I(\theta)-I(0)}{I(\pi)-I(0)}
=-\frac{\cos^3\theta}{8}-\frac{3\cos\theta}{8}+\frac{1}{2},
\quad
0\le\theta\le\pi
\end{equation*}

The probability of observing scattering events in the interval $\theta_1$ to $\theta_2$ is
\begin{equation*}
P(\theta_1\le\theta\le\theta_2)=F(\theta_2)-F(\theta_1)
\end{equation*}

\subsection*{Data from SLAC PEP experiment}
See www.hepdata.net/record/ins216031, Table 1, $s=(29.0\,\text{GeV})^2$.

\begin{center}
\begin{tabular}{|c|c|}
\hline
$x$ & $y$\\
\hline
$-0.925$ & 67.08\\
$-0.85\phantom{0}$ & 58.67\\
$-0.75\phantom{0}$ & 54.66\\
$-0.65\phantom{0}$ & 51.72\\
$-0.55\phantom{0}$ & 43.70\\
$-0.45\phantom{0}$ & 41.12\\
$-0.35\phantom{0}$ & 39.71\\
$-0.25\phantom{0}$ & 35.34\\
$-0.15\phantom{0}$ & 33.35\\
$-0.05\phantom{0}$ & 34.69\\
$\phantom{+}0.05\phantom{0}$ & 34.05\\
$\phantom{+}0.15\phantom{0}$ & 34.48\\
$\phantom{+}0.25\phantom{0}$ & 34.66\\
$\phantom{+}0.35\phantom{0}$ & 35.23\\
$\phantom{+}0.45\phantom{0}$ & 35.60\\
$\phantom{+}0.55\phantom{0}$ & 40.13\\
$\phantom{+}0.65\phantom{0}$ & 42.56\\
$\phantom{+}0.75\phantom{0}$ & 46.37\\
$\phantom{+}0.85\phantom{0}$ & 49.28\\
$\phantom{+}0.925$ & 55.70\\
\hline
\end{tabular}
\end{center}

Data $x$ and $y$ have the following relationship with the differential cross section formula.
\begin{equation*}
x=\cos\theta,
\quad
y=s\frac{d\sigma}{d\cos\theta}=2\pi s\frac{d\sigma}{d\Omega}
\end{equation*}

The cross section formula is
\begin{equation*}
\frac{d\sigma}{d\Omega}=\frac{\alpha^2}{4s}\left(1+\cos^2\theta\right)\times(\hbar c)^2
\end{equation*}

To compute predicted values $\hat{y}$, multiply by $10^{37}$ to convert square meters to nanobarns.
\begin{equation*}
\hat y=2\pi s\frac{d\sigma}{d\Omega}=\frac{\pi\alpha^2}{2}\left(1+x^2\right)\times(\hbar c)^2\times10^{37}
\end{equation*}

The following table shows predicted values $\hat{y}$.

\begin{center}
\begin{tabular}{|c|c|c|}
\hline
$x$ & $y$ & $\hat{y}$ \\
\hline
$-0.925$ & 67.08 & 60.44\\
$-0.85\phantom{0}$ & 58.67 & 56.10\\
$-0.75\phantom{0}$ & 54.66 & 50.89\\
$-0.65\phantom{0}$ & 51.72 & 46.33\\
$-0.55\phantom{0}$ & 43.70 & 42.42\\
$-0.45\phantom{0}$ & 41.12 & 39.17\\
$-0.35\phantom{0}$ & 39.71 & 36.56\\
$-0.25\phantom{0}$ & 35.34 & 34.61\\
$-0.15\phantom{0}$ & 33.35 & 33.30\\
$-0.05\phantom{0}$ & 34.69 & 32.65\\
$\phantom{+}0.05\phantom{0}$ & 34.05 & 32.65\\
$\phantom{+}0.15\phantom{0}$ & 34.48 & 33.30\\
$\phantom{+}0.25\phantom{0}$ & 34.66 & 34.61\\
$\phantom{+}0.35\phantom{0}$ & 35.23 & 36.56\\
$\phantom{+}0.45\phantom{0}$ & 35.60 & 39.17\\
$\phantom{+}0.55\phantom{0}$ & 40.13 & 42.42\\
$\phantom{+}0.65\phantom{0}$ & 42.56 & 46.33\\
$\phantom{+}0.75\phantom{0}$ & 46.37 & 50.89\\
$\phantom{+}0.85\phantom{0}$ & 49.28 & 56.10\\
$\phantom{+}0.925$ & 55.70 & 60.44\\
\hline
\end{tabular}
\end{center}

The coefficient of determination $R^2$ measures how well predicted values fit the data.
\begin{equation*}
R^2=1-\frac{\sum(y-\hat{y})^2}{\sum(y-\bar{y})^2}=0.87
\end{equation*}

The result indicates that the model $d\sigma$ explains 87\% of the variance in the data.

\subsection*{Electroweak model}
The following differential cross section formula from electroweak
theory results in a better fit to the
data.\footnote{F. Mandl and G. Shaw, {\it Quantum Field Theory Revised Edition,} 316.}

\begin{equation*}
\frac{d\sigma}{d\Omega}=F(s)\big(1+\cos^2\theta\big)+G(s)\cos\theta
\end{equation*}

where
\begin{align*}
F(s)&=\frac{\alpha^2}{4s}
\left(
1+\frac{g_V^2}{\sqrt{2}\pi}\left(\frac{m_Z^2}{s-m_Z^2}\right)\left(\frac{sG}{\alpha}\right)
+\frac{(g_A^2+g_V^2)^2}{8\pi^2}\left(\frac{m_Z^2}{s-m_Z^2}\right)^2\left(\frac{sG}{\alpha}\right)^2
\right)
\\
G(s)&=\frac{\alpha^2}{4s}
\left(
\frac{\sqrt{2}g_A^2}{\pi}\left(\frac{m_Z^2}{s-m_Z^2}\right)\left(\frac{sG}{\alpha}\right)
+\frac{g_A^2g_V^2}{\pi^2}\left(\frac{m_Z^2}{s-m_Z^2}\right)^2\left(\frac{sG}{\alpha}\right)^2
\right)
\end{align*}

and
\begin{align*}
g_A&=-0.5
\\
g_V&=-0.0348
\\
m_Z&=91.17\,\text{GeV}
\\
G&=1.166\times10^{-5}\,\text{GeV}^{-2}
\end{align*}

The corresponding formula for $\hat{y}$ is
\begin{equation*}
\hat{y}=2\pi\left[F(s)(1+x^2)+G(s)x\right]\times(\hbar c)^2\times10^{37}
\end{equation*}

where $\sqrt{s}=29\,\text{GeV}$ is the center of mass collision energy.
Here are the predicted values $\hat{y}$ based on the above formula.

\begin{center}
\begin{tabular}{|c|c|c|}
\hline
$x$ & $y$ & $\hat{y}$ \\
\hline
$-0.925$ & 67.08 & 65.59\\
$-0.85\phantom{0}$ & 58.67 & 60.84\\
$-0.75\phantom{0}$ & 54.66 & 55.07\\
$-0.65\phantom{0}$ & 51.72 & 49.96\\
$-0.55\phantom{0}$ & 43.70 & 45.49\\
$-0.45\phantom{0}$ & 41.12 & 41.69\\
$-0.35\phantom{0}$ & 39.71 & 38.53\\
$-0.25\phantom{0}$ & 35.34 & 36.02\\
$-0.15\phantom{0}$ & 33.35 & 34.17\\
$-0.05\phantom{0}$ & 34.69 & 32.97\\
$\phantom{+}0.05\phantom{0}$ & 34.05 & 32.42\\
$\phantom{+}0.15\phantom{0}$ & 34.48 & 32.53\\
$\phantom{+}0.25\phantom{0}$ & 34.66 & 33.28\\
$\phantom{+}0.35\phantom{0}$ & 35.23 & 34.69\\
$\phantom{+}0.45\phantom{0}$ & 35.60 & 36.75\\
$\phantom{+}0.55\phantom{0}$ & 40.13 & 39.47\\
$\phantom{+}0.65\phantom{0}$ & 42.56 & 42.83\\
$\phantom{+}0.75\phantom{0}$ & 46.37 & 46.85\\
$\phantom{+}0.85\phantom{0}$ & 49.28 & 51.52\\
$\phantom{+}0.925$ & 55.70 & 55.45\\
\hline
\end{tabular}
\end{center}

The coefficient of determination $R^2$ is
\begin{equation*}
R^2=1-\frac{\sum(y-\hat{y})^2}{\sum(y-\bar{y})^2}=0.98
\end{equation*}

The result indicates that electroweak theory explains 98\% of the variance in the data.

\subsection*{Notes}
Here are a few notes about how the demo script works.

\bigskip
In component notation, traces are sums over a repeated index, in this case $\alpha$.
\begin{align*}
\mathop{\rm Tr}\left((\slashed{p}_3+M)\gamma^\mu(\slashed{p}_4-M)\gamma^\nu\right)
&=
(\slashed{p}_3+M)^\alpha{}_\beta
\gamma^{\mu\beta}{}_\rho
(\slashed{p}_4-M)^\rho{}_\sigma
\gamma^{\nu\sigma}{}_\alpha
\\
\mathop{\rm Tr}\left((\slashed{p}_2-m)\gamma_\mu(\slashed{p}_1+m)\gamma_\nu\right)
&=
(\slashed{p}_2-m)^\alpha{}_\beta
\gamma_\mu{}^\beta{}_\rho
(\slashed{p}_1+m)^\rho{}_\sigma
\gamma_\nu{}^\sigma{}_\alpha
\end{align*}

To convert the above formulas to Eigenmath code,
the $\gamma$ tensors need to be transposed
so that repeated indices are adjacent to each other.
Also, multiply $\gamma^\mu$ by the metric tensor to lower the index.
\begin{align*}
\gamma^{\beta\mu}{}_\rho\quad&\rightarrow\quad
\text{\tt gammaT = transpose(gamma)}\\
\gamma^\beta{}_{\mu\rho}\quad&\rightarrow\quad
\text{\tt gammaL = transpose(dot(gmunu,gamma))}
\end{align*}

Define the following $4\times4$ matrices.
\begin{align*}
(\slashed{p}_1+m)\quad&\rightarrow\quad\text{\tt X1 = pslash1 + m I}\\
(\slashed{p}_2-m)\quad&\rightarrow\quad\text{\tt X2 = pslash2 - m I}\\
(\slashed{p}_3+M)\quad&\rightarrow\quad\text{\tt X3 = pslash3 + M I}\\
(\slashed{p}_4-M)\quad&\rightarrow\quad\text{\tt X4 = pslash4 - M I}
\end{align*}

Then
\begin{align*}
(\slashed{p}_3+M)^\alpha{}_\beta
\gamma^{\mu\beta}{}_\rho
(\slashed{p}_4-M)^\rho{}_\sigma
\gamma^{\nu\sigma}{}_\alpha
\quad&\rightarrow\quad
\text{\tt T1 = contract(dot(X3,gammaT,X4,gammaT),1,4)}
\\
(\slashed{p}_2-m)^\alpha{}_\beta
\gamma_\mu{}^\beta{}_\rho
(\slashed{p}_1+m)^\rho{}_\sigma
\gamma_\nu{}^\sigma{}_\alpha
\quad&\rightarrow\quad
\text{\tt T2 = contract(dot(X2,gammaL,X1,gammaL),1,4)}
\end{align*}

Next, multiply matrices and sum over repeated indices.
The dot function sums over $\nu$ then the contract function
sums over $\mu$. The transpose makes the $\nu$ indices adjacent
as required by the dot function.
$$
\mathop{\rm Tr}(\cdots\gamma^\mu\cdots\gamma^\nu)\mathop{\rm Tr}(\cdots\gamma_\mu\cdots\gamma_\nu)
\quad\rightarrow\quad
\text{\tt contract(dot(T1,transpose(T2)))}
$$

\end{document}
