\documentclass[12pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath}
\usepackage{slashed}
\usepackage{tikz} % includes graphicx
\parindent=0pt
\begin{document}

\section*{Annihilation}
Electron-positron annihilation emits two photons.
\begin{center}
\begin{tikzpicture}
\draw[dashed] (0,0) circle (0.5cm);
\draw[thick,->] (2,0) node[anchor=west] {$e^+$} -- (0.6,0);
\draw[thick,->] (-2,0) node[anchor=east] {$e^-$} -- (-0.6,0);
\draw[thick,->] (0.40,0.40) -- (1.3,1.3) node[anchor=south west] {$\gamma$};
\draw[thick,->] (-0.4,-0.4) -- (-1.3,-1.3) node[anchor=north east] {$\gamma$};
\draw (1,0.5) node {$\theta$};
\end{tikzpicture}
\end{center}

Here is the same diagram with momentum and spinor labels.
\begin{center}
\begin{tikzpicture}
\draw[dashed] (0,0) circle (0.5cm);
\draw[thick,->] (2,0) node[anchor=west] {$p_2, v_{2b}$} -- (0.6,0);
\draw[thick,->] (-2,0) node[anchor=east] {$p_1, u_{1a}$} -- (-0.6,0);
\draw[thick,->] (0.40,0.40) -- (1.3,1.3) node[anchor=south west] {$p_3$};
\draw[thick,->] (-0.4,-0.4) -- (-1.3,-1.3) node[anchor=north east] {$p_4$};
\draw (1,0.5) node {$\theta$};
\end{tikzpicture}
\end{center}

In a typical collider experiment the momentum vectors are
\begin{align*}
p_1&=
\underset{\text{inbound electron}}
{
\begin{pmatrix}E\\0\\0\\p\end{pmatrix}
}
&
p_2&=
\underset{\text{inbound positron}}
{
\begin{pmatrix}E\\0\\0\\-p\end{pmatrix}
}
&
p_3&=
\underset{\text{outbound photon}}
{
\begin{pmatrix}E\\ E\sin\theta\cos\phi\\ E\sin\theta\sin\phi\\ E\cos\theta\end{pmatrix}
}
&
p_4&=
\underset{\text{outbound photon}}
{
\begin{pmatrix}E\\ -E\sin\theta\cos\phi\\ -E\sin\theta\sin\phi\\ -E\cos\theta\end{pmatrix}
}
\end{align*}

Symbol $p$ is incident momentum.
Symbol $E$ is total energy $E=\sqrt{p^2+m^2}$ where $m$ is electron mass.
Polar angle $\theta$ is the observed scattering angle.
Azimuth angle $\phi$ cancels out in scattering calculations.

\bigskip
The spinors are
\begin{align*}
u_{11}&=
\underset{\substack{\text{inbound electron}\\\text{spin up}}}
{
\begin{pmatrix}E+m\\0\\p\\0\end{pmatrix}
}
&
v_{21}&=
\underset{\substack{\text{inbound positron}\\\text{spin up}}}
{
\begin{pmatrix}-p\\0\\E+m\\0\end{pmatrix}
}
\\[1ex]
u_{12}&=
\underset{\substack{\text{inbound electron}\\\text{spin down}}}
{
\begin{pmatrix}0\\E+m\\0\\-p\end{pmatrix}
}
&
v_{22}&=
\underset{\substack{\text{inbound positron}\\\text{spin down}}}
{
\begin{pmatrix}0\\p\\0\\E+m\end{pmatrix}
}
\end{align*}

Spinor subscripts have 1 for spin up and 2 for spin down.
The spinors are not individually normalized.
Instead, a combined spinor normalization constant $N=(E+m)^2$ will be used.

\bigskip
This is the probability density for spin state $ab$.
The formula is derived from Feynman diagrams for annihilation.
\begin{equation*}
|\mathcal{M}_{ab}|^2
=
\frac{e^4}{N}
\left|
-\frac{\bar{v}_{2b}\gamma^\mu(\slashed{q}_1+m)\gamma^\nu u_{1a}}{t-m^2}
-\frac{\bar{v}_{2b}\gamma^\nu(\slashed{q}_2+m)\gamma^\mu u_{1a}}{u-m^2}
\right|^2
\end{equation*}

Symbol $e$ is electron charge and
\begin{align*}
q_1&=p_1-p_3
\\
q_2&=p_1-p_4
\end{align*}
Symbols $t$ and $u$ are Mandelstam variables
\begin{align*}
t&=q_1^2=(p_1-p_3)^2
\\
u&=q_2^2=(p_1-p_4)^2
\end{align*}

Let
\begin{equation*}
a_1=\bar{v}_{2b}\gamma^\mu(\slashed{q}_1+m)\gamma^\nu u_{1a},
\quad
a_2=\bar{v}_{2b}\gamma^\nu(\slashed{q}_2+m)\gamma^\mu u_{1a}
\end{equation*}

Then
\begin{align*}
|\mathcal{M}_{ab}|^2&=\frac{e^4}{N}\left|-\frac{a_1}{t-m^2}-\frac{a_2}{u-m^2}\right|^2\\
&=
\frac{e^4}{N}
\left(-\frac{a_1}{t-m^2}-\frac{a_2}{u-m^2}\right)
\left(-\frac{a_1}{t-m^2}-\frac{a_2}{u-m^2}\right)^*\\
&=
\frac{e^4}{N}\left(
\frac{a_1a_1^*}{(t-m^2)^2}
+\frac{a_1a_2^*}{(t-m^2)(u-m^2)}
+\frac{a_1^*a_2}{(t-m^2)(u-m^2)}
+\frac{a_2a_2^*}{(u-m^2)^2}
\right)
\end{align*}

The expected probability density $\langle|\mathcal{M}|^2\rangle$
is computed by summing $|\mathcal{M}_{ab}|^2$ over all spin and polarization states
and then dividing by the number of inbound states.
There are four inbound states.
The sum over polarization states is already accomplished by contraction
of $aa^*$ over $\mu$ and $\nu$.
\begin{align*}
\langle|\mathcal{M}|^2\rangle
&=\frac{1}{4}\sum_{a=1}^2\sum_{b=1}^2|\mathcal{M}_{ab}|^2\\
&=\frac{e^4}{4N}\sum_{a=1}^2\sum_{b=1}^2
\left(
\frac{a_1a_1^*}{(t-m^2)^2}
+\frac{a_1a_2^*}{(t-m^2)(u-m^2)}
+\frac{a_1^*a_2}{(t-m^2)(u-m^2)}
+\frac{a_2a_2^*}{(u-m^2)^2}
\right)
\end{align*}

The Casimir trick uses matrix arithmetic to compute sums.
\begin{align*}
f_{11}&=\frac{1}{N} \sum_{a=1}^2\sum_{b=1}^2 a_1a_1^*=\mathop{\rm Tr}
\left(
(\slashed{p}_1+m)\gamma^\mu(\slashed{q}_1+m)\gamma^\nu(\slashed{p}_2-m)\gamma_\nu(\slashed{q}_1+m)\gamma_\mu
\right)
\\
f_{12}&=\frac{1}{N} \sum_{a=1}^2\sum_{b=1}^2 a_1a_2^*=\mathop{\rm Tr}
\left(
(\slashed{p}_1+m)\gamma^\mu(\slashed{q}_2+m)\gamma^\nu(\slashed{p}_2-m)\gamma_\mu(\slashed{q}_1+m)\gamma_\nu
\right)
\\
f_{22}&=\frac{1}{N} \sum_{a=1}^2\sum_{b=1}^2 a_2a_2^*=\mathop{\rm Tr}
\left(
(\slashed{p}_1+m)\gamma^\mu(\slashed{q}_2+m)\gamma^\nu(\slashed{p}_2-m)\gamma_\nu(\slashed{q}_2+m)\gamma_\mu
\right)
\end{align*}

Hence
\begin{equation*}
\langle|\mathcal{M}|^2\rangle
=
\frac{e^4}{4}
\left(
\frac{f_{11}}{(t-m^2)^2}
+\frac{f_{12}}{(t-m^2)(u-m^2)}
+\frac{f_{12}^*}{(t-m^2)(u-m^2)}
+\frac{f_{22}}{(u-m^2)^2}
\right)
\end{equation*}

The following formulas are equivalent to the Casimir trick.
(Recall that $a\cdot b=a^\mu g_{\mu\nu}b^\nu$)
\begin{align*}
f_{11}&=
 32 (p_1 \cdot p_3) (p_1 \cdot p_4) -
 32 m^2 (p_1 \cdot p_2) +
 64 m^2 (p_1 \cdot p_3) +
 32 m^2 (p_1 \cdot p_4) - 64 m^4
\\
f_{12}&=
 16 m^2 (p_1 \cdot p_3) +
 16 m^2 (p_1 \cdot p_4) - 32 m^4
\\
f_{22}&=
 32 (p_1 \cdot p_3) (p_1 \cdot p_4) -
 32 m^2 (p_1 \cdot p_2) +
 32 m^2 (p_1 \cdot p_3) +
 64 m^2 (p_1 \cdot p_4) - 64 m^4
\end{align*}

In Mandelstam variables
\begin{align*}
s&=(p_1+p_2)^2
\\
t&=(p_1-p_3)^2
\\
u&=(p_1-p_4)^2
\end{align*}
the formulas are
\begin{align*}
f_{11}&=8 t u - 24 t m^2 - 8 u m^2 - 8 m^4
\\
f_{12}&=8 s m^2 - 32 m^4
\\
f_{22}&=8 t u - 8 t m^2 - 24 u m^2 - 8 m^4
\end{align*}

\subsection*{High energy approximation}
For high energy experiments $E\gg m$ a useful approximation is to set $m=0$ and obtain
\begin{align*}
f_{11}&=8tu
\\
f_{12}&=0
\\
f_{22}&=8tu
\end{align*}

Hence
\begin{align*}
\langle|\mathcal{M}|^2\rangle
&=
\frac{e^4}{4}
\left(
\frac{8tu}{t^2}
+\frac{8tu}{u^2}
\right)
\\
&=
2e^4
\left(
\frac{u}{t}
+\frac{t}{u}
\right)
\end{align*}

For $m=0$ the Mandelstam variables are
\begin{align*}
s&=4E^2\\
t&=-2E^2(1-\cos\theta)
\\
u&=-2E^2(1+\cos\theta)
\end{align*}

Hence
\begin{equation*}
\langle|\mathcal{M}|^2\rangle
=2e^4\left(
\frac{1+\cos\theta}{1-\cos\theta}+
\frac{1-\cos\theta}{1+\cos\theta}
\right)
\end{equation*}

\subsection*{Cross section}
The differential cross section is
\begin{equation*}
\frac{d\sigma}{d\Omega}=\frac{\langle|\mathcal{M}|^2\rangle}{4(4\pi\varepsilon_0)^2s},\quad s=(p_1+p_2)^2
\end{equation*}

For the high energy approximation $m=0$ we have
\begin{equation*}
\langle|\mathcal{M}|^2\rangle=2e^4\left(
\frac{1+\cos\theta}{1-\cos\theta}+
\frac{1-\cos\theta}{1+\cos\theta}
\right)
\quad\text{and}\quad
s=4E^2
\end{equation*}

Substitute for $\langle|\mathcal{M}|^2\rangle$.
\begin{equation*}
\frac{d\sigma}{d\Omega}
=\frac{e^4}{2(4\pi\varepsilon_0)^2s}\left(\frac{1+\cos\theta}{1-\cos\theta}+\frac{1-\cos\theta}{1+\cos\theta}\right)
\end{equation*}

Noting that
\begin{equation*}
e^2=4\pi\varepsilon_0\alpha\hbar c
\end{equation*}
we can also write
\begin{equation*}
\frac{d\sigma}{d\Omega}
=
\frac{\alpha^2(\hbar c)^2}{2s}
\left(
\frac{1+\cos\theta}{1-\cos\theta}+
\frac{1-\cos\theta}{1+\cos\theta}
\right)
\end{equation*}

We can integrate $d\sigma$ to obtain a cumulative distribution function.
Let $I(\theta)$ be the following integral of $d\sigma$.
\begin{equation*}
I(\theta)
=\int
\left(
\frac{1+\cos\theta}{1-\cos\theta}+
\frac{1-\cos\theta}{1+\cos\theta}
\right)
\sin\theta\,d\theta
\end{equation*}

The result is
\begin{equation*}
I(\theta)=2\cos\theta+2\log(1-\cos\theta)-2\log(1+\cos\theta)
\end{equation*}

The cumulative distribution function is
\begin{equation*}
F(\theta)=\frac{I(\theta)-I(a)}{I(\pi-a)-I(a)},
\quad
a\le\theta\le\pi-a
\end{equation*}

Angular support is limited to an arbitrary $a>0$
because $I(0)$ and $I(\pi)$ are undefined.

\bigskip
The probability of observing scattering events in the interval
$\theta_1$ to $\theta_2$ is
\begin{equation*}
P(\theta_1\le\theta\le\theta_2)=F(\theta_2)-F(\theta_1)
\end{equation*}

\subsection*{Data from DESY PETRA experiment}
See www.hepdata.net/record/ins191231, Table 2, 14.0 GeV.

\begin{center}
\begin{tabular}{|c|c|}
\hline
$x$ & $y$\\
\hline
$0.0502$ & 0.09983\\
$0.1505$ & 0.10791\\
$0.2509$ & 0.12026\\
$0.3512$ & 0.13002\\
$0.4516$ & 0.17681\\
$0.5521$ & 0.1957\phantom{0}\\
$0.6526$ & 0.279\phantom{00}\\
$0.7312$ & 0.33204\\
\hline
\end{tabular}
\end{center}

Data $x$ and $y$ have the following relationship
with the differential cross section formula.
\begin{equation*}
x=\cos\theta,
\quad
y=\frac{d\sigma}{d\Omega}
\end{equation*}

The cross section formula is
\begin{equation*}
\frac{d\sigma}{d\Omega}
=
\frac{\alpha^2}{2s}
\left(
\frac{1+\cos\theta}{1-\cos\theta}+
\frac{1-\cos\theta}{1+\cos\theta}
\right)\times(\hbar c)^2
\end{equation*}

To compute predicted values $\hat{y}$,
multiply by $10^{37}$ to convert square meters to nanobarns.
\begin{equation*}
\hat{y}
=
\frac{\alpha^2}{2s}
\left(
\frac{1+x}{1-x}+
\frac{1-x}{1+x}
\right)
\times(\hbar c)^2
\times10^{37}
\end{equation*}

The following table shows predicted values $\hat{y}$ for $s=(14.0\,\text{GeV})^2$.

\begin{center}
\begin{tabular}{|c|c|c|}
\hline
$x$ & $y$ & $\hat{y}$\\
\hline
$0.0502$ & 0.09983 & 0.106325\\
$0.1505$ & 0.10791 & 0.110694\\
$0.2509$ & 0.12026 & 0.120005\\
$0.3512$ & 0.13002 & 0.135559\\
$0.4516$ & 0.17681 & 0.159996\\
$0.5521$ & 0.1957\phantom{0} & 0.198562\\
$0.6526$ & 0.279\phantom{00} & 0.262745\\
$0.7312$ & 0.33204 & 0.348884\\
\hline
\end{tabular}
\end{center}

The coefficient of determination $R^2$ measures how well predicted values fit the data.
\begin{equation*}
R^2=1-\frac{\sum(y-\hat{y})^2}{\sum(y-\bar{y})^2}=0.98
\end{equation*}

The result indicates that the model $d\sigma$ explains 98\% of the variance in the data.

\subsection*{Notes}
Here are some notes on how the Eigenmath scripts work.

\bigskip
To convert $a_1$ and $a_2$ to Eigenmath code,
it is instructive to write $a_1$ and $a_2$ in full component form.
\begin{equation*}
a_1^{\mu\nu}
=\bar{v}_{2\alpha}\gamma^{\mu\alpha}{}_\beta(\slashed{q}_1+m)^\beta{}_\rho\gamma^{\nu\rho}{}_\sigma u_1^\sigma
\quad
a_2^{\nu\mu}
=\bar{v}_{2\alpha}\gamma^{\nu\alpha}{}_\beta(\slashed{q}_2+m)^\beta{}_\rho\gamma^{\mu\rho}{}_\sigma u_1^\sigma
\end{equation*}

Transpose the $\gamma$ tensors to form inner products over $\alpha$ and $\rho$.
\begin{equation*}
a_1^{\mu\nu}
=\bar{v}_{2\alpha}\gamma^{\alpha\mu}{}_\beta(\slashed{q}_1+m)^\beta{}_\rho\gamma^{\rho\nu}{}_\sigma u_1^\sigma
\quad
a_2^{\nu\mu}
=\bar{v}_{2\alpha}\gamma^{\alpha\nu}{}_\beta(\slashed{q}_2+m)^\beta{}_\rho\gamma^{\rho\mu}{}_\sigma u_1^\sigma
\end{equation*}

Convert transposed $\gamma$ to Eigenmath code.
\begin{equation*}
\gamma^{\alpha\mu}{}_\beta
\quad\rightarrow\quad
\text{\tt gammaT = transpose(gamma)}
\end{equation*}

Then to compute $a_1$ we have
\begin{multline*}
a_1=\bar{v}_{2\alpha}\gamma^{\alpha\mu}{}_\beta(\slashed{q}_1+m)^\beta{}_\rho\gamma^{\rho\nu}{}_\sigma u_1^\sigma
\\
\rightarrow\quad
\text{\tt a1 = dot(v2bar[s2],gammaT,qslash1 + m I,gammaT,u1[s1])}
\end{multline*}

where $s_1$ and $s_2$ are spin indices.
Similarly for $a_2$ we have
\begin{multline*}
a_2=\bar{v}_{2\alpha}\gamma^{\alpha\mu}{}_\beta(\slashed{q}_2+m)^\beta{}_\rho\gamma^{\rho\nu}{}_\sigma u_1^\sigma
\\
\rightarrow\quad
\text{\tt a2 = dot(v2bar[s2],gammaT,qslash2 + m I,gammaT,u1[s1])}
\end{multline*}

In component notation the product $a_1a_1^*$ is
\begin{equation*}
a_1a_1^*=a_1^{\mu\nu}a_1^{*\mu\nu}
\end{equation*}

To sum over $\mu$ and $\nu$ it is necessary to lower indices with the metric tensor.
Also, transpose $a_1^*$ to form an inner product with $\nu$.
\begin{equation*}
a_1a_1^*=a_1^{\mu\nu}a_{1\nu\mu}^*
\end{equation*}

Convert to Eigenmath code.
The dot function sums over $\nu$ and the contract function sums over $\mu$.
\begin{equation*}
a_1a_1^*
\quad\rightarrow\quad
\text{\tt a11 = contract(dot(a1,gmunu,transpose(conj(a1)),gmunu))}
\end{equation*}

Similarly for $a_2a_2^*$ we have
\begin{equation*}
a_2a_2^*
\quad\rightarrow\quad
\text{\tt a22 = contract(dot(a2,gmunu,transpose(conj(a2)),gmunu))}
\end{equation*}

The product $a_1a_2^*$ does not require a transpose because $a_2=a_2^{\nu\mu}$.
\begin{equation*}
a_1^{\mu\nu}a_{2\nu\mu}^*
\quad\rightarrow\quad
\text{\tt a12 = contract(dot(a1,gmunu,conj(a2),gmunu))}
\end{equation*}

In component notation, a trace operator becomes a sum over an index, in this case $\alpha$.
\begin{align*}
f_{11}
&=
\mathop{\rm Tr}
\left(
(\slashed{p}_1+m)\gamma^\mu(\slashed{q}_1+m)\gamma^\nu(\slashed{p}_2-m)\gamma_\nu(\slashed{q}_1+m)\gamma_\mu
\right)\\
&=
(\slashed{p}_1+m)^\alpha{}_\beta
\gamma^{\mu\beta}{}_\rho
(\slashed{q}_1+m)^\rho{}_\sigma
\gamma^{\nu\sigma}{}_\tau
(\slashed{p}_2-m)^\tau{}_\delta
\gamma_\nu{}^\delta{}_\eta
(\slashed{q}_1+m)^\eta{}_\xi
\gamma_\mu{}^\xi{}_\alpha
\end{align*}

As before, transpose $\gamma$ tensors to form inner products.
\begin{equation*}
f_{11}=
(\slashed{p}_1+m)^\alpha{}_\beta
\gamma^{\beta\mu}{}_\rho
(\slashed{q}_1+m)^\rho{}_\sigma
\gamma^{\sigma\nu}{}_\tau
(\slashed{p}_2-m)^\tau{}_\delta
\gamma^\delta{}_{\nu\eta}
(\slashed{q}_1+m)^\eta{}_\xi
\gamma^\xi{}_{\mu\alpha}
\end{equation*}

This is the code for transposing $\gamma$.
\begin{align*}
\gamma^{\beta\mu}{}_\beta
&\quad\rightarrow\quad
\text{\tt gammaT = transpose(gamma)}
\\
\gamma^\delta{}_{\nu\eta}
&\quad\rightarrow\quad
\text{\tt gammaL = transpose(dot(gmunu,gamma))}
\end{align*}

To convert $f_{11}$ to Eigenmath code, use an intermediate variable $T$ for the inner product.
\begin{equation*}
T^{\alpha\mu\nu}{}_{\nu\mu\alpha}
\quad\rightarrow\quad
\text{\tt T = dot(P1,gammaT,Q1,gammaT,P2,gammaL,Q1,gammaL)}
\end{equation*}

Now sum over the indices of $T$.
The innermost contract sums over $\nu$ then the next contract sums over $\mu$.
Finally the outermost contract sums over $\alpha$.
\begin{equation*}
f_{11}\quad\rightarrow\quad
\text{\tt f11 = contract(contract(contract(T,3,4),2,3))}
\end{equation*}

Follow suit for $f_{22}$.
For $f_{12}$ the order of the rightmost $\mu$ and $\nu$ is reversed.
\begin{equation*}
f_{12}=\mathop{\rm Tr}
\left(
(\slashed{p}_1+m)\gamma^\mu(\slashed{q}_2+m)\gamma^\nu(\slashed{p}_2-m)\gamma_\mu(\slashed{q}_1+m)\gamma_\nu
\right)
\end{equation*}

The resulting inner product is $T^{\alpha\mu\nu}{}_{\mu\nu\alpha}$
so the contraction is different.
\begin{equation*}
f_{12}
\quad\rightarrow\quad
\text{\tt f12 = contract(contract(contract(T,3,5),2,3))}
\end{equation*}

The innermost contract sums over $\nu$ followed by sum over $\mu$ then sum over $\alpha$.

\end{document}
